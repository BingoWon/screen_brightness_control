<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>screen_brightness_control.windows API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>screen_brightness_control.windows</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import wmi, threading, pythoncom, ctypes, win32api, time
from ctypes import windll, byref, Structure, WinError, POINTER, WINFUNCTYPE
from ctypes.wintypes import BOOL, HMONITOR, HDC, RECT, LPARAM, DWORD, BYTE, WCHAR, HANDLE
from . import flatten_list, _monitor_brand_lookup, filter_monitors, Monitor, __cache__

def _wmi_init():
    &#39;&#39;&#39;internal function to create and return a wmi instance&#39;&#39;&#39;
    #WMI calls don&#39;t work in new threads so we have to run this check
    if threading.current_thread() != threading.main_thread():
        pythoncom.CoInitialize()
    instance = wmi.WMI(namespace=&#39;wmi&#39;)
    return instance

class WMI:
    &#39;&#39;&#39;collection of screen brightness related methods using the WMI API&#39;&#39;&#39;
    def get_display_info(display=None):
        &#39;&#39;&#39;
        Returns a dictionary of info about all detected monitors

        Args:
            display (str or int): [*Optional*] the monitor to return info about. Pass in the serial number, name, model, edid or index

        Returns:
            list: list of dictonaries
            dict: one dictionary if a monitor is specified
        
        Example:
            ```python
            import screen_brightness_control as sbc

            info = sbc.windows.WMI.get_display_info()
            for i in info:
                print(&#39;================&#39;)
                for key, value in i.items():
                    print(key, &#39;:&#39;, value)

            # get information about the first WMI addressable monitor
            primary_info = sbc.windows.WMI.get_display_info(0)

            # get information about a monitor with a specific name
            benq_info = sbc.windows.WMI.get_display_info(&#39;BenQ GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        try:
            info = __cache__.get(&#39;wmi_monitor_info&#39;)
        except:
            info = []
            a = 0
            try:
                wmi = _wmi_init()
                monitors = wmi.WmiMonitorBrightness()
                try:descriptors = {i.InstanceName:i.WmiGetMonitorRawEEdidV1Block(0) for i in wmi.WmiMonitorDescriptorMethods()}
                except:pass
                for m in monitors:
                    instance = m.InstanceName.split(&#39;\\&#39;)
                    serial = instance[-1]
                    model = instance[1]

                    man_id = model[:3]
                    try:man_id, manufacturer = _monitor_brand_lookup(model[:3])
                    except:manufacturer = None

                    try:
                        edid = &#39;&#39;
                        for char in descriptors[m.InstanceName][0]:
                            char = str(hex(char)).replace(&#39;0x&#39;,&#39;&#39;)
                            if len(char)==1:
                                char = &#39;0&#39;+char
                            edid+=char
                    except:
                        edid = None

                    info.append({&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: WMI, &#39;edid&#39;:edid})
                    a+=1
            except:
                pass
            __cache__.store(&#39;wmi_monitor_info&#39;, info)
        if display!=None:
            indexes = [i[&#39;index&#39;] for i in filter_monitors(display=display, haystack=info)]
            info = [info[i] for i in indexes]
        return info
    def get_display_names():
        &#39;&#39;&#39;
        Returns names of all displays that can be addressed by WMI

        Returns:
            list: list of strings
        
        Example:
            ```python
            import screen_brightness_control as sbc

            for name in sbc.windows.WMI.get_display_names():
                print(name)
            ```
        &#39;&#39;&#39;
        return [i[&#39;name&#39;] for i in WMI.get_display_info()]
    def set_brightness(value, display = None, no_return = False):
        &#39;&#39;&#39;
        Sets the display brightness for Windows using WMI

        Args:
            value (int): The percentage to set the brightness to
            display (int or str): The index display you wish to set the brightness for OR the model of the display, as returned by self.get_display_names
            no_return (bool): if True, this function returns None, otherwise it returns the result of `WMI.get_brightness()`

        Returns:
            int: from 0 to 100 if only one display&#39;s brightness is requested
            list: list of integers if multiple displays are requested
            None: if `no_return` is set to `True`
        
        Raises:
            LookupError: if the given display cannot be found

        Example:
            ```python
            import screen_brightness_control as sbc

            # set brightness of WMI addressable monitors to 50%
            sbc.windows.WMI.set_brightness(50)

            # set the primary display brightness to 75%
            sbc.windows.WMI.set_brightness(75, display = 0)

            # set the brightness of a named monitor to 25%
            sbc.windows.WMI.set_brightness(25, display = &#39;BenQ GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        brightness_method = _wmi_init().WmiMonitorBrightnessMethods()
        if display!=None:
            indexes = [i[&#39;index&#39;] for i in filter_monitors(display=display, method=&#39;wmi&#39;)]
            brightness_method = [brightness_method[i] for i in indexes]
        for method in brightness_method:
            method.WmiSetBrightness(value,0)
        return WMI.get_brightness(display=display) if not no_return else None
    def get_brightness(display = None):
        &#39;&#39;&#39;
        Returns the current display brightness using the `wmi` API

        Args:
            display (int): The index display you wish to get the brightness of OR the model of that display

        Returns:
            int: from 0 to 100 if only one display&#39;s brightness is requested
            list: list of integers if multiple displays are requested
        
        Raises:
            LookupError: if the given display cannot be found
        
        Example:
            ```python
            import screen_brightness_control as sbc

            # get brightness of all WMI addressable monitors
            current_brightness = sbc.windows.WMI.get_brightness()
            if type(current_brightness) is int:
                print(&#39;There is only one detected display&#39;)
            else:
                print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

            # get the primary display brightness
            primary_brightness = sbc.windows.WMI.get_brightness(display = 0)

            # get the brightness of a named monitor
            benq_brightness = sbc.windows.WMI.get_brightness(display = &#39;BenQ GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        brightness_method = _wmi_init().WmiMonitorBrightness()
        if display!=None:
            displays = WMI.get_display_info(display)
            if displays is dict:
                displays = [displays]
            brightness_method = [brightness_method[i[&#39;index&#39;]] for i in displays]

        values = [i.CurrentBrightness for i in brightness_method]
        return values[0] if len(values)==1 else values

class VCP:
    &#39;&#39;&#39;Collection of screen brightness related methods using the DDC/CI commands&#39;&#39;&#39;
    _MONITORENUMPROC = WINFUNCTYPE(BOOL, HMONITOR, HDC, POINTER(RECT), LPARAM)
    class _PHYSICAL_MONITOR(Structure):
        &#39;&#39;&#39;internal class, do not call&#39;&#39;&#39;
        _fields_ = [(&#39;handle&#39;, HANDLE),
                    (&#39;description&#39;, WCHAR * 128)]

    def iter_physical_monitors():
        &#39;&#39;&#39;
        A generator to iterate through all physical monitors and then close them again afterwards, yielding their handles.
        It is not recommended to use this function unless you are familiar with `ctypes` and `windll`

        Raises:
            ctypes.WinError: upon failure to enumerate through the monitors

        Example:
            ```python
            import screen_brightness_control as sbc

            for monitor in sbc.windows.VCP.iter_physical_monitors():
                print(sbc.windows.VCP.get_monitor_caps(monitor))
            ```
        &#39;&#39;&#39;
        def callback(hmonitor, hdc, lprect, lparam):
            monitors.append(HMONITOR(hmonitor))
            return True

        monitors = []
        if not windll.user32.EnumDisplayMonitors(None, None, VCP._MONITORENUMPROC(callback), None):
            raise WinError(&#39;EnumDisplayMonitors failed&#39;)
        for monitor in monitors:
            # Get physical monitor count
            count = DWORD()
            if not windll.dxva2.GetNumberOfPhysicalMonitorsFromHMONITOR(monitor, byref(count)):
                raise WinError()
            if count.value&gt;0:
                # Get physical monitor handles
                physical_array = (VCP._PHYSICAL_MONITOR * count.value)()
                if not windll.dxva2.GetPhysicalMonitorsFromHMONITOR(monitor, count.value, physical_array):
                    raise WinError()
                for item in physical_array:
                    yield item.handle
                    windll.dxva2.DestroyPhysicalMonitor(item.handle)
    def filter_displays(display, *args):
        &#39;&#39;&#39;
        Deprecated. Redirects to top-level `filter_monitors` function.
        Searches through the information for all detected VCP displays and attempts to return the info matching the value given.
        Will attempt to match against index, name, model, edid and serial

        Args:
            args (tuple): [*Optional*] if `args` isn&#39;t empty the function searches through args[0]. Otherwise it searches through the return of `VCP.get_display_info()`
            display (str or int): what you are searching for. Can be serial number, name, model number, edid string or index of the display

        Raises:
            IndexError: if the display value is an int and an `IndexError` occurs when using it as a list index
            LookupError: if the display, as a str, does not have a match

        Returns:
            dict
        
        Example:
            ```python
            import screen_brightness_control as sbc

            search = &#39;GL2450H&#39;
            match = sbc.windows.VCP.filter_displays(search)
            print(match)
            # EG output: {&#39;name&#39;: &#39;BenQ GL2450H&#39;, &#39;model&#39;: &#39;GL2450H&#39;, ... }
            ```
        &#39;&#39;&#39;
        if len(args)==1:
            info = args[0]
        else:
            info = VCP.get_display_info()
        return filter_monitors(display = display, haystack = info)
    def get_display_info(display=None):
        &#39;&#39;&#39;
        Returns a dictionary of info about all detected monitors or a selection of monitors

        Args:
            display (int or str): [*Optional*] the monitor to return info about. Pass in the serial number, name, model, edid or index

        Returns:
            list: list of dicts if `args` is empty or there are multiple values passed in `args`
            dict: if one value was passed through `args` and it matched a known monitor
        
        Example:
            ```python
            import screen_brightness_control as sbc

            # get the information about all monitors
            vcp_info = sbc.windows.VCP.get_display_info()
            print(vcp_info)
            # EG output: [{&#39;name&#39;: &#39;BenQ GL2450H&#39;, &#39;model&#39;: &#39;GL2450H&#39;, ... }, {&#39;name&#39;: &#39;Dell U2211H&#39;, &#39;model&#39;: &#39;U2211H&#39;, ... }]

            # get information about a monitor with this specific model
            bnq_info = sbc.windows.VCP.get_display_info(&#39;GL2450H&#39;)
            # EG output: {&#39;name&#39;: &#39;BenQ GL2450H&#39;, &#39;model&#39;: &#39;GL2450H&#39;, ... }
            ```
        &#39;&#39;&#39;
        try:
            info = __cache__.get(&#39;vcp_monitor_info&#39;)
        except:
            info = []
            try:
                # collect all monitor UIDs (derived from DeviceID)
                monitor_uids = {}
                for i in win32api.EnumDisplayMonitors():
                    tmp = win32api.GetMonitorInfo(i[0])
                    device = None
                    # iterate up to 4 display adapters
                    for j in range(5):
                        try:
                            # i have no idea what this 3rd parameter does but the code doesn&#39;t work without it
                            device = win32api.EnumDisplayDevices(tmp[&#39;Device&#39;], j, 1)
                            break
                        except:
                            pass
                    if device!=None:
                        monitor_uids[device.DeviceID.split(&#39;#&#39;)[2]] = device
                        #monitor_uids.append(device.DeviceID.split(&#39;#&#39;)[2])

                # this seperation of monitors is to fix issue #6
                # https://github.com/Crozzers/screen_brightness_control/issues/6
                wmi = _wmi_init()
                monitors = []
                extras = []
                for m in wmi.WmiMonitorID():
                    name = m.InstanceName.replace(&#39;_0&#39;,&#39;&#39;,1).split(&#39;\\&#39;)[2]
                    if name in monitor_uids.keys():
                        monitors.append(m)
                    else:
                        extras.append(m)

                # sort the monitors in the same order as win32api reports them
                # because the first item in win32api&#39;s list is usually the primary display
                monitors = sorted(monitors, key=lambda x:list(monitor_uids.keys()).index(x.InstanceName.replace(&#39;_0&#39;,&#39;&#39;,1).split(&#39;\\&#39;)[2]))
                monitors+=extras

                # get all available edid strings
                try:descriptors = {i.InstanceName:i.WmiGetMonitorRawEEdidV1Block(0) for i in wmi.WmiMonitorDescriptorMethods()}
                except:pass
                a=0
                for monitor in monitors:
                    valid = False
                    name, model, serial, manufacturer, man_id, edid = None, None, None, None, None, None
                    try:
                        serial = bytes(monitor.SerialNumberID).decode().replace(&#39;\x00&#39;, &#39;&#39;)
                        manufacturer, model = bytes(monitor.UserFriendlyName).decode().replace(&#39;\x00&#39;, &#39;&#39;).split(&#39; &#39;)
                        manufacturer = manufacturer.lower().capitalize()
                        try:
                            man_id, manufacturer = _monitor_brand_lookup(manufacturer)
                        except:
                            man_id = None
                        try:
                            edid = &#39;&#39;
                            for char in descriptors[monitor.InstanceName][0]:
                                char = str(hex(char)).replace(&#39;0x&#39;,&#39;&#39;)
                                if len(char) == 1:
                                    char = &#39;0&#39;+char
                                edid+=char
                        except:
                            edid = None
                        if manufacturer==&#39;Dell&#39;:
                            raise Exception
                        valid = True
                    except:
                        try:
                            # if there&#39;s an error scraping the WMI data, try scraping more basic data instead
                            monitor = monitor_uids[monitor.InstanceName.replace(&#39;_0&#39;,&#39;&#39;,1).split(&#39;\\&#39;)[2]]
                            dev_id = monitor.DeviceID.split(&#39;#&#39;)
                            serial = dev_id[2] # not an actual serial but the Windows UID
                            man_id = dev_id[1][:3]
                            model = dev_id[1][3:]
                            try:
                                man_id, manufacturer = _monitor_brand_lookup(man_id)
                            except:
                                manufacturer = None
                            try:
                                edid = &#39;&#39;
                                for char in descriptors[monitor.InstanceName][0]:
                                    char = str(hex(char)).replace(&#39;0x&#39;,&#39;&#39;)
                                    if len(char) == 1:
                                        char = &#39;0&#39;+char
                                    edid+=char
                            except:
                                edid = None
                            valid = True
                        except:
                            pass
                    if valid:
                        info.append({&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: VCP, &#39;edid&#39;: edid})
                        a+=1
            except:
                pass
            __cache__.store(&#39;vcp_monitor_info&#39;, info)
        if display!=None:
            try:
                info = filter_monitors(display=display, haystack=info)
                return info[0] if len(info)==1 else info
            except:
                pass
        return info
    def get_monitor_caps(monitor):
        &#39;&#39;&#39;
        Fetches and returns the VCP capabilities string of a monitor.
        This function takes anywhere from 1-2 seconds to run

        Args:
            monitor: a monitor handle as returned by `VCP.iter_physical_monitors()`
        
        Returns:
            str: a string of the monitor&#39;s capabilities
        
        Examples:
            ```python
            import screen_brightness_control as sbc

            for monitor in sbc.windows.VCP.iter_physical_monitors():
                print(sbc.windows.VCP.get_monitor_caps(monitor))
            # EG output: &#39;(prot(monitor)type(LCD)model(GL2450HM)cmds(01 02 03 07 0C F3)vcp(02 04 05 08 0B 0C 10 12 14(04 05 08 0B) 16 18 1A 52 60(01 03 11)62 8D(01 02)AC AE B2 B6 C0 C6 C8 C9 CA(01 02) CC(01 02 03 04 05 06 09 0A 0B 0D 0E 12 14 1A 1E 1F 20)D6(01 05) DF)mswhql(1)mccs_ver(2.1)asset_eep(32)mpu_ver(1.02))&#39;
            ```
        &#39;&#39;&#39;
        caps_string_length = DWORD()
        if not windll.dxva2.GetCapabilitiesStringLength(monitor,ctypes.byref(caps_string_length)):
            return
        caps_string = (ctypes.c_char * caps_string_length.value)()
        if not windll.dxva2.CapabilitiesRequestAndCapabilitiesReply(monitor, caps_string, caps_string_length):
            return
        return caps_string.value.decode(&#39;ASCII&#39;)
    def get_display_names():
        &#39;&#39;&#39;
        Return the names of each detected monitor
        
        Returns:
            list: list of strings
        
        Example:
            ```python
            import screen_brightness_control as sbc

            names = sbc.windows.VCP.get_display_names()
            print(names)
            # EG output: [&#39;BenQ GL2450H&#39;, &#39;Dell U2211H&#39;]
            ```
        &#39;&#39;&#39;
        return [i[&#39;name&#39;] for i in VCP.get_display_info()]
    def get_brightness(display=None):
        &#39;&#39;&#39;
        Retrieve the brightness of all connected displays using the `ctypes.windll` API

        Args:
            display (int or str): the specific display you wish to query. Is passed to `filter_monitors` to match to a display
        
        Returns:
            list: list of ints from 0 to 100 if multiple displays are detected and the `display` kwarg is not set
            int: from 0 to 100 if there is only one display detected or the `display` kwarg is set
        
        Examples:
            ```python
            import screen_brightness_control as sbc

            # Get the brightness for all detected displays
            current_brightness = sbc.windows.VCP.get_brightness()
            if type(current_brightness) is int:
                print(&#39;There is only one detected display&#39;)
            else:
                print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)
            
            # Get the brightness for the primary display
            primary_brightness = sbc.windows.VCP.get_brightness(display = 0)

            # Get the brightness for a secondary display
            secondary_brightness = sbc.windows.VCP.get_brightness(display = 1)

            # Get the brightness for a display with the model &#39;GL2450H&#39;
            benq_brightness = sbc.windows.VCP.get_brightness(display = &#39;GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        if display!=None:
            all_monitors = VCP.get_display_info()
            monitors = filter_monitors(display = display, haystack=all_monitors)
            indexes = [i[&#39;index&#39;] for i in monitors]

        count = 0
        values = []
        for m in VCP.iter_physical_monitors():
            try:
                v = __cache__.get(&#39;vcp_&#39;+all_monitors[count][&#39;serial&#39;]+&#39;_brightness&#39;)
            except:
                cur_out = DWORD()
                for i in range(10):
                    if windll.dxva2.GetVCPFeatureAndVCPFeatureReply(HANDLE(m), BYTE(0x10), None, byref(cur_out), None):
                        v = cur_out.value
                        break
                    else:
                        time.sleep(0.02)
                        v = None
                del(cur_out)
            if v!=None and (display==None or (count in indexes)):
                if display!=None and count in indexes:
                    try:__cache__.store(&#39;vcp_&#39;+all_monitors[count][&#39;serial&#39;]+&#39;_brightness&#39;, v, expires=0.1)
                    except IndexError:pass
                values.append(v)
            count+=1

        if values==[]:
            return None
        return values[0] if len(values)==1 else values
    def set_brightness(value, display=None, no_return=False):
        &#39;&#39;&#39;
        Sets the brightness for all connected displays using the `ctypes.windll` API

        Args:
            display (int or str): the specific display you wish to query. Is passed to `filter_monitors` to match to a display
            no_return (bool): if set to `True` this function will return `None`
        
        Returns:
            The result of `VCP.get_brightness()` (with the same `display` kwarg) if `no_return` is not set
        
        Examples:
            ```python
            import screen_brightness_control as sbc

            # Set the brightness for all detected displays to 50%
            sbc.windows.VCP.set_brightness(50)
            
            # Set the brightness for the primary display to 75%
            sbc.windows.VCP.set_brightness(75, display = 0)

            # Set the brightness for a secondary display to 25%
            sbc.windows.VCP.set_brightness(25, display = 1)

            # Set the brightness for a display with the model &#39;GL2450H&#39; to 100%
            sbc.windows.VCP.set_brightness(100, display = &#39;GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        if display!=None:
            indexes = [i[&#39;index&#39;] for i in filter_monitors(display = display, haystack = VCP.get_display_info())]

        __cache__.expire(startswith=&#39;vcp_&#39;, endswith=&#39;_brightness&#39;)

        count = 0
        for m in VCP.iter_physical_monitors():
            if display==None or (count in indexes):
                for i in range(10):
                    if windll.dxva2.SetVCPFeature(HANDLE(m), BYTE(0x10), DWORD(value)):
                        break
                    else:
                        time.sleep(0.02)
            count+=1
        return VCP.get_brightness(display=display) if not no_return else None


def list_monitors_info(method = None, allow_duplicates = False):
    &#39;&#39;&#39;
    Lists detailed information about all detected monitors

    Args:
        method (str): the method the monitor can be addressed by. Can be &#39;wmi&#39; or &#39;vcp&#39;
        allow_duplicates (bool): whether to filter out duplicate displays (displays with the same EDID) or not

    Returns:
        list: list of dictionaries upon success, empty list upon failure

    Example:
        ```python
        import screen_brightness_control as sbc

        monitors = sbc.windows.list_monitors_info()
        for info in monitors:
            print(&#39;=======================&#39;)
            print(&#39;Name:&#39;, info[&#39;name&#39;]) # the manufacturer name plus the model
            print(&#39;Model:&#39;, info[&#39;model&#39;]) # the general model of the display
            print(&#39;Serial:&#39;, info[&#39;serial&#39;]) # a unique string assigned by Windows to this display
            print(&#39;Manufacturer:&#39;, info[&#39;manufacturer&#39;]) # the name of the brand of the monitor
            print(&#39;Manufacturer ID:&#39;, info[&#39;manufacturer_id&#39;]) # the 3 letter code corresponding to the brand name, EG: BNQ -&gt; BenQ  
            print(&#39;Index:&#39;, info[&#39;index&#39;]) # the index of that display FOR THE SPECIFIC METHOD THE DISPLAY USES
            print(&#39;Method:&#39;, info[&#39;method&#39;]) # the method this monitor can be addressed by
            print(&#39;EDID:&#39;, info[&#39;edid&#39;]) # the EDID string of the monitor
        ```
    &#39;&#39;&#39;
    try:
        return __cache__.get(&#39;windows_monitors_info&#39;, method=method, allow_duplicates=allow_duplicates)
    except:
        methods = [WMI,VCP]
        if method!=None:
            methods = [i for i in methods if i.__name__.lower() == method.lower()]
            if methods==[]:
                raise ValueError(&#39;method kwarg must be \&#39;wmi\&#39; or \&#39;vcp\&#39;&#39;)

        info = []
        edids = []
        for m in methods:
            #to make sure each display (with unique edid) is only reported once
            for i in m.get_display_info():
                if allow_duplicates or i[&#39;serial&#39;] not in edids:
                    edids.append(i[&#39;serial&#39;])
                    info.append(i)
        __cache__.store(&#39;windows_monitors_info&#39;, info, method=method, allow_duplicates=allow_duplicates)
        return info

def list_monitors(method = None):
    &#39;&#39;&#39;
    Returns a list of all addressable monitor names

    Args:
        method (str): the method the monitor can be addressed by. Can be &#39;wmi&#39; or &#39;vcp&#39;

    Returns:
        list: list of strings

    Example:
        ```python
        import screen_brightness_control as sbc

        monitors = sbc.windows.list_monitors()
        # EG output: [&#39;BenQ GL2450H&#39;, &#39;Dell U2211H&#39;]
        ```
    &#39;&#39;&#39;
    return [i[&#39;name&#39;] for i in list_monitors_info(method=method)]

def __set_and_get_brightness(*args, display = None, method = None, meta_method = &#39;get&#39;, **kwargs):
    &#39;&#39;&#39;internal function, do not call.
    either sets the brightness or gets it. Exists because set_brightness and get_brightness only have a couple differences&#39;&#39;&#39;
    errors = []
    try: # filter known list of monitors according to kwargs
        monitors = filter_monitors(display = display, method = method)
    except Exception as e:
        errors.append([&#39;&#39;,type(e).__name__, e])
    else:
        output = []
        for m in monitors: # add the output of each brightness method to the output list
            try:
                output.append(
                    getattr(m[&#39;method&#39;], meta_method+&#39;_brightness&#39;)(*args, display = m[&#39;serial&#39;], **kwargs)
                )
            except Exception as e:
                output.append(None)
                errors.append([f&#34;{m[&#39;name&#39;]} ({m[&#39;serial&#39;]})&#34;, type(e).__name__, e])

        if output!=[] and not (all(i==None for i in output) and (&#39;no_return&#39; not in kwargs.keys() or kwargs[&#39;no_return&#39;]==False)):
            # flatten and return any output (taking into account the no_return parameter)
            output = flatten_list(output)
            return output[0] if len(output)==1 else output

    #if function hasn&#39;t already returned it has failed
    msg=&#39;\n&#39;
    for e in errors:
        msg+=f&#39;\t{e[0]} -&gt; {e[1]}: {e[2]}\n&#39;
    if msg==&#39;\n&#39;:
        msg+=&#39;\tno valid output was received from brightness methods&#39;
    raise Exception(msg)

def set_brightness(value, display = None, method = None, **kwargs):
    &#39;&#39;&#39;
    Sets the brightness of any connected monitors

    Args:
        value (int): Sets the brightness to this value as a percentage
        display (int or str): the specific display you wish to adjust. can be index, model, name or serial of the display
        method (str): the method to use (&#39;wmi&#39; or &#39;vcp&#39;)
        kwargs (dict): passed directly to the chosen brightness method

    Returns:
        Whatever the called methods return (See `WMI.set_brightness` and `VCP.set_brightness` for details).
        Typically it will list, int (0 to 100) or None
    
    Raises:
        LookupError: if the chosen display (with method if applicable) is not found
        ValueError: if the chosen method is invalid
        TypeError: if the value given for `display` is not int or str
        Exception: if the brightness could not be set by any method

    Example:
        ```python
        import screen_brightness_control as sbc

        # set the current brightness to 50%
        sbc.windows.set_brightness(50)

        # set the brightness of the primary display to 75%
        sbc.windows.set_brightness(75, display = 0)

        # set the brightness of any displays using VCP to 25%
        sbc.windows.set_brightness(25, method = &#39;vcp&#39;)

        # set the brightness of displays with the model name &#39;BenQ GL2450H&#39; (see `list_monitors` and `list_monitors_info`) to 100%
        sbc.windows.set_brightness(100, display = &#39;BenQ GL2450H&#39;)
        ```
    &#39;&#39;&#39;
    # this function is called because set_brightness and get_brightness only differed by 1 line of code
    # so I made another internal function to reduce the filesize
    return __set_and_get_brightness(value, display=display, method=method, meta_method=&#39;set&#39;, **kwargs)

def get_brightness(display = None, method = None, **kwargs):
    &#39;&#39;&#39;
    Returns the brightness of any connected monitors

    Args:
        display (int or str): the specific display you wish to adjust. can be index, model, name or serial of the display
        method (str): the method to use (&#39;wmi&#39; or &#39;vcp&#39;)
        kwargs (dict): passed directly to chosen brightness method

    Returns:
        int: from 0 to 100 if only one display is detected or the `display` kwarg is set
        list: list of integers if multiple displays are detected and the `display` kwarg isn&#39;t set (invalid monitors return `None`)
    
    Raises:
        LookupError: if the chosen display (with method if applicable) is not found
        ValueError: if the chosen method is invalid
        TypeError: if the value given for `display` is not int or str
        Exception: if the brightness could not be obtained by any method

    Example:
        ```python
        import screen_brightness_control as sbc

        # get the current brightness
        current_brightness = sbc.windows.get_brightness()
        if type(current_brightness) is int:
            print(&#39;There is only one detected display&#39;)
        else:
            print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

        # get the brightness of the primary display
        primary_brightness = sbc.windows.get_brightness(display = 0)

        # get the brightness of any displays using VCP
        vcp_brightness = sbc.windows.get_brightness(method = &#39;vcp&#39;)

        # get the brightness of displays with the model name &#39;BenQ GL2450H&#39;
        benq_brightness = sbc.windows.get_brightness(display = &#39;BenQ GL2450H&#39;)
        ```
    &#39;&#39;&#39;
    # this function is called because set_brightness and get_brightness only differed by 1 line of code
    # so I made another internal function to reduce the filesize
    return __set_and_get_brightness(display=display, method=method, meta_method=&#39;get&#39;, **kwargs)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="screen_brightness_control.windows.get_brightness"><code class="name flex">
<span>def <span class="ident">get_brightness</span></span>(<span>display=None, method=None, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the brightness of any connected monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>the specific display you wish to adjust. can be index, model, name or serial of the display</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>the method to use ('wmi' or 'vcp')</dd>
<dt><strong><code>kwargs</code></strong> :&ensp;<code>dict</code></dt>
<dd>passed directly to chosen brightness method</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>from 0 to 100 if only one display is detected or the <code>display</code> kwarg is set</dd>
<dt><code>list</code></dt>
<dd>list of integers if multiple displays are detected and the <code>display</code> kwarg isn't set (invalid monitors return <code>None</code>)</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>LookupError</code></dt>
<dd>if the chosen display (with method if applicable) is not found</dd>
<dt><code>ValueError</code></dt>
<dd>if the chosen method is invalid</dd>
<dt><code>TypeError</code></dt>
<dd>if the value given for <code>display</code> is not int or str</dd>
<dt><code>Exception</code></dt>
<dd>if the brightness could not be obtained by any method</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# get the current brightness
current_brightness = sbc.windows.get_brightness()
if type(current_brightness) is int:
    print('There is only one detected display')
else:
    print('There are', len(current_brightness), 'detected displays')

# get the brightness of the primary display
primary_brightness = sbc.windows.get_brightness(display = 0)

# get the brightness of any displays using VCP
vcp_brightness = sbc.windows.get_brightness(method = 'vcp')

# get the brightness of displays with the model name 'BenQ GL2450H'
benq_brightness = sbc.windows.get_brightness(display = 'BenQ GL2450H')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_brightness(display = None, method = None, **kwargs):
    &#39;&#39;&#39;
    Returns the brightness of any connected monitors

    Args:
        display (int or str): the specific display you wish to adjust. can be index, model, name or serial of the display
        method (str): the method to use (&#39;wmi&#39; or &#39;vcp&#39;)
        kwargs (dict): passed directly to chosen brightness method

    Returns:
        int: from 0 to 100 if only one display is detected or the `display` kwarg is set
        list: list of integers if multiple displays are detected and the `display` kwarg isn&#39;t set (invalid monitors return `None`)
    
    Raises:
        LookupError: if the chosen display (with method if applicable) is not found
        ValueError: if the chosen method is invalid
        TypeError: if the value given for `display` is not int or str
        Exception: if the brightness could not be obtained by any method

    Example:
        ```python
        import screen_brightness_control as sbc

        # get the current brightness
        current_brightness = sbc.windows.get_brightness()
        if type(current_brightness) is int:
            print(&#39;There is only one detected display&#39;)
        else:
            print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

        # get the brightness of the primary display
        primary_brightness = sbc.windows.get_brightness(display = 0)

        # get the brightness of any displays using VCP
        vcp_brightness = sbc.windows.get_brightness(method = &#39;vcp&#39;)

        # get the brightness of displays with the model name &#39;BenQ GL2450H&#39;
        benq_brightness = sbc.windows.get_brightness(display = &#39;BenQ GL2450H&#39;)
        ```
    &#39;&#39;&#39;
    # this function is called because set_brightness and get_brightness only differed by 1 line of code
    # so I made another internal function to reduce the filesize
    return __set_and_get_brightness(display=display, method=method, meta_method=&#39;get&#39;, **kwargs)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.list_monitors"><code class="name flex">
<span>def <span class="ident">list_monitors</span></span>(<span>method=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a list of all addressable monitor names</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>the method the monitor can be addressed by. Can be 'wmi' or 'vcp'</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of strings</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

monitors = sbc.windows.list_monitors()
# EG output: ['BenQ GL2450H', 'Dell U2211H']
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def list_monitors(method = None):
    &#39;&#39;&#39;
    Returns a list of all addressable monitor names

    Args:
        method (str): the method the monitor can be addressed by. Can be &#39;wmi&#39; or &#39;vcp&#39;

    Returns:
        list: list of strings

    Example:
        ```python
        import screen_brightness_control as sbc

        monitors = sbc.windows.list_monitors()
        # EG output: [&#39;BenQ GL2450H&#39;, &#39;Dell U2211H&#39;]
        ```
    &#39;&#39;&#39;
    return [i[&#39;name&#39;] for i in list_monitors_info(method=method)]</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.list_monitors_info"><code class="name flex">
<span>def <span class="ident">list_monitors_info</span></span>(<span>method=None, allow_duplicates=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Lists detailed information about all detected monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>the method the monitor can be addressed by. Can be 'wmi' or 'vcp'</dd>
<dt><strong><code>allow_duplicates</code></strong> :&ensp;<code>bool</code></dt>
<dd>whether to filter out duplicate displays (displays with the same EDID) or not</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of dictionaries upon success, empty list upon failure</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

monitors = sbc.windows.list_monitors_info()
for info in monitors:
    print('=======================')
    print('Name:', info['name']) # the manufacturer name plus the model
    print('Model:', info['model']) # the general model of the display
    print('Serial:', info['serial']) # a unique string assigned by Windows to this display
    print('Manufacturer:', info['manufacturer']) # the name of the brand of the monitor
    print('Manufacturer ID:', info['manufacturer_id']) # the 3 letter code corresponding to the brand name, EG: BNQ -&gt; BenQ  
    print('Index:', info['index']) # the index of that display FOR THE SPECIFIC METHOD THE DISPLAY USES
    print('Method:', info['method']) # the method this monitor can be addressed by
    print('EDID:', info['edid']) # the EDID string of the monitor
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def list_monitors_info(method = None, allow_duplicates = False):
    &#39;&#39;&#39;
    Lists detailed information about all detected monitors

    Args:
        method (str): the method the monitor can be addressed by. Can be &#39;wmi&#39; or &#39;vcp&#39;
        allow_duplicates (bool): whether to filter out duplicate displays (displays with the same EDID) or not

    Returns:
        list: list of dictionaries upon success, empty list upon failure

    Example:
        ```python
        import screen_brightness_control as sbc

        monitors = sbc.windows.list_monitors_info()
        for info in monitors:
            print(&#39;=======================&#39;)
            print(&#39;Name:&#39;, info[&#39;name&#39;]) # the manufacturer name plus the model
            print(&#39;Model:&#39;, info[&#39;model&#39;]) # the general model of the display
            print(&#39;Serial:&#39;, info[&#39;serial&#39;]) # a unique string assigned by Windows to this display
            print(&#39;Manufacturer:&#39;, info[&#39;manufacturer&#39;]) # the name of the brand of the monitor
            print(&#39;Manufacturer ID:&#39;, info[&#39;manufacturer_id&#39;]) # the 3 letter code corresponding to the brand name, EG: BNQ -&gt; BenQ  
            print(&#39;Index:&#39;, info[&#39;index&#39;]) # the index of that display FOR THE SPECIFIC METHOD THE DISPLAY USES
            print(&#39;Method:&#39;, info[&#39;method&#39;]) # the method this monitor can be addressed by
            print(&#39;EDID:&#39;, info[&#39;edid&#39;]) # the EDID string of the monitor
        ```
    &#39;&#39;&#39;
    try:
        return __cache__.get(&#39;windows_monitors_info&#39;, method=method, allow_duplicates=allow_duplicates)
    except:
        methods = [WMI,VCP]
        if method!=None:
            methods = [i for i in methods if i.__name__.lower() == method.lower()]
            if methods==[]:
                raise ValueError(&#39;method kwarg must be \&#39;wmi\&#39; or \&#39;vcp\&#39;&#39;)

        info = []
        edids = []
        for m in methods:
            #to make sure each display (with unique edid) is only reported once
            for i in m.get_display_info():
                if allow_duplicates or i[&#39;serial&#39;] not in edids:
                    edids.append(i[&#39;serial&#39;])
                    info.append(i)
        __cache__.store(&#39;windows_monitors_info&#39;, info, method=method, allow_duplicates=allow_duplicates)
        return info</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.set_brightness"><code class="name flex">
<span>def <span class="ident">set_brightness</span></span>(<span>value, display=None, method=None, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Sets the brightness of any connected monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>value</code></strong> :&ensp;<code>int</code></dt>
<dd>Sets the brightness to this value as a percentage</dd>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>the specific display you wish to adjust. can be index, model, name or serial of the display</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>the method to use ('wmi' or 'vcp')</dd>
<dt><strong><code>kwargs</code></strong> :&ensp;<code>dict</code></dt>
<dd>passed directly to the chosen brightness method</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>Whatever the called methods return (See <code><a title="screen_brightness_control.windows.WMI.set_brightness" href="#screen_brightness_control.windows.WMI.set_brightness">WMI.set_brightness()</a></code> and <code><a title="screen_brightness_control.windows.VCP.set_brightness" href="#screen_brightness_control.windows.VCP.set_brightness">VCP.set_brightness()</a></code> for details).
Typically it will list, int (0 to 100) or None</p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>LookupError</code></dt>
<dd>if the chosen display (with method if applicable) is not found</dd>
<dt><code>ValueError</code></dt>
<dd>if the chosen method is invalid</dd>
<dt><code>TypeError</code></dt>
<dd>if the value given for <code>display</code> is not int or str</dd>
<dt><code>Exception</code></dt>
<dd>if the brightness could not be set by any method</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# set the current brightness to 50%
sbc.windows.set_brightness(50)

# set the brightness of the primary display to 75%
sbc.windows.set_brightness(75, display = 0)

# set the brightness of any displays using VCP to 25%
sbc.windows.set_brightness(25, method = 'vcp')

# set the brightness of displays with the model name 'BenQ GL2450H' (see &lt;code&gt;&lt;a title=&quot;screen_brightness_control.windows.list_monitors&quot; href=&quot;#screen_brightness_control.windows.list_monitors&quot;&gt;list\_monitors()&lt;/a&gt;&lt;/code&gt; and &lt;code&gt;&lt;a title=&quot;screen_brightness_control.windows.list_monitors_info&quot; href=&quot;#screen_brightness_control.windows.list_monitors_info&quot;&gt;list\_monitors\_info()&lt;/a&gt;&lt;/code&gt;) to 100%
sbc.windows.set_brightness(100, display = 'BenQ GL2450H')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_brightness(value, display = None, method = None, **kwargs):
    &#39;&#39;&#39;
    Sets the brightness of any connected monitors

    Args:
        value (int): Sets the brightness to this value as a percentage
        display (int or str): the specific display you wish to adjust. can be index, model, name or serial of the display
        method (str): the method to use (&#39;wmi&#39; or &#39;vcp&#39;)
        kwargs (dict): passed directly to the chosen brightness method

    Returns:
        Whatever the called methods return (See `WMI.set_brightness` and `VCP.set_brightness` for details).
        Typically it will list, int (0 to 100) or None
    
    Raises:
        LookupError: if the chosen display (with method if applicable) is not found
        ValueError: if the chosen method is invalid
        TypeError: if the value given for `display` is not int or str
        Exception: if the brightness could not be set by any method

    Example:
        ```python
        import screen_brightness_control as sbc

        # set the current brightness to 50%
        sbc.windows.set_brightness(50)

        # set the brightness of the primary display to 75%
        sbc.windows.set_brightness(75, display = 0)

        # set the brightness of any displays using VCP to 25%
        sbc.windows.set_brightness(25, method = &#39;vcp&#39;)

        # set the brightness of displays with the model name &#39;BenQ GL2450H&#39; (see `list_monitors` and `list_monitors_info`) to 100%
        sbc.windows.set_brightness(100, display = &#39;BenQ GL2450H&#39;)
        ```
    &#39;&#39;&#39;
    # this function is called because set_brightness and get_brightness only differed by 1 line of code
    # so I made another internal function to reduce the filesize
    return __set_and_get_brightness(value, display=display, method=method, meta_method=&#39;set&#39;, **kwargs)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="screen_brightness_control.windows.VCP"><code class="flex name class">
<span>class <span class="ident">VCP</span></span>
</code></dt>
<dd>
<div class="desc"><p>Collection of screen brightness related methods using the DDC/CI commands</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class VCP:
    &#39;&#39;&#39;Collection of screen brightness related methods using the DDC/CI commands&#39;&#39;&#39;
    _MONITORENUMPROC = WINFUNCTYPE(BOOL, HMONITOR, HDC, POINTER(RECT), LPARAM)
    class _PHYSICAL_MONITOR(Structure):
        &#39;&#39;&#39;internal class, do not call&#39;&#39;&#39;
        _fields_ = [(&#39;handle&#39;, HANDLE),
                    (&#39;description&#39;, WCHAR * 128)]

    def iter_physical_monitors():
        &#39;&#39;&#39;
        A generator to iterate through all physical monitors and then close them again afterwards, yielding their handles.
        It is not recommended to use this function unless you are familiar with `ctypes` and `windll`

        Raises:
            ctypes.WinError: upon failure to enumerate through the monitors

        Example:
            ```python
            import screen_brightness_control as sbc

            for monitor in sbc.windows.VCP.iter_physical_monitors():
                print(sbc.windows.VCP.get_monitor_caps(monitor))
            ```
        &#39;&#39;&#39;
        def callback(hmonitor, hdc, lprect, lparam):
            monitors.append(HMONITOR(hmonitor))
            return True

        monitors = []
        if not windll.user32.EnumDisplayMonitors(None, None, VCP._MONITORENUMPROC(callback), None):
            raise WinError(&#39;EnumDisplayMonitors failed&#39;)
        for monitor in monitors:
            # Get physical monitor count
            count = DWORD()
            if not windll.dxva2.GetNumberOfPhysicalMonitorsFromHMONITOR(monitor, byref(count)):
                raise WinError()
            if count.value&gt;0:
                # Get physical monitor handles
                physical_array = (VCP._PHYSICAL_MONITOR * count.value)()
                if not windll.dxva2.GetPhysicalMonitorsFromHMONITOR(monitor, count.value, physical_array):
                    raise WinError()
                for item in physical_array:
                    yield item.handle
                    windll.dxva2.DestroyPhysicalMonitor(item.handle)
    def filter_displays(display, *args):
        &#39;&#39;&#39;
        Deprecated. Redirects to top-level `filter_monitors` function.
        Searches through the information for all detected VCP displays and attempts to return the info matching the value given.
        Will attempt to match against index, name, model, edid and serial

        Args:
            args (tuple): [*Optional*] if `args` isn&#39;t empty the function searches through args[0]. Otherwise it searches through the return of `VCP.get_display_info()`
            display (str or int): what you are searching for. Can be serial number, name, model number, edid string or index of the display

        Raises:
            IndexError: if the display value is an int and an `IndexError` occurs when using it as a list index
            LookupError: if the display, as a str, does not have a match

        Returns:
            dict
        
        Example:
            ```python
            import screen_brightness_control as sbc

            search = &#39;GL2450H&#39;
            match = sbc.windows.VCP.filter_displays(search)
            print(match)
            # EG output: {&#39;name&#39;: &#39;BenQ GL2450H&#39;, &#39;model&#39;: &#39;GL2450H&#39;, ... }
            ```
        &#39;&#39;&#39;
        if len(args)==1:
            info = args[0]
        else:
            info = VCP.get_display_info()
        return filter_monitors(display = display, haystack = info)
    def get_display_info(display=None):
        &#39;&#39;&#39;
        Returns a dictionary of info about all detected monitors or a selection of monitors

        Args:
            display (int or str): [*Optional*] the monitor to return info about. Pass in the serial number, name, model, edid or index

        Returns:
            list: list of dicts if `args` is empty or there are multiple values passed in `args`
            dict: if one value was passed through `args` and it matched a known monitor
        
        Example:
            ```python
            import screen_brightness_control as sbc

            # get the information about all monitors
            vcp_info = sbc.windows.VCP.get_display_info()
            print(vcp_info)
            # EG output: [{&#39;name&#39;: &#39;BenQ GL2450H&#39;, &#39;model&#39;: &#39;GL2450H&#39;, ... }, {&#39;name&#39;: &#39;Dell U2211H&#39;, &#39;model&#39;: &#39;U2211H&#39;, ... }]

            # get information about a monitor with this specific model
            bnq_info = sbc.windows.VCP.get_display_info(&#39;GL2450H&#39;)
            # EG output: {&#39;name&#39;: &#39;BenQ GL2450H&#39;, &#39;model&#39;: &#39;GL2450H&#39;, ... }
            ```
        &#39;&#39;&#39;
        try:
            info = __cache__.get(&#39;vcp_monitor_info&#39;)
        except:
            info = []
            try:
                # collect all monitor UIDs (derived from DeviceID)
                monitor_uids = {}
                for i in win32api.EnumDisplayMonitors():
                    tmp = win32api.GetMonitorInfo(i[0])
                    device = None
                    # iterate up to 4 display adapters
                    for j in range(5):
                        try:
                            # i have no idea what this 3rd parameter does but the code doesn&#39;t work without it
                            device = win32api.EnumDisplayDevices(tmp[&#39;Device&#39;], j, 1)
                            break
                        except:
                            pass
                    if device!=None:
                        monitor_uids[device.DeviceID.split(&#39;#&#39;)[2]] = device
                        #monitor_uids.append(device.DeviceID.split(&#39;#&#39;)[2])

                # this seperation of monitors is to fix issue #6
                # https://github.com/Crozzers/screen_brightness_control/issues/6
                wmi = _wmi_init()
                monitors = []
                extras = []
                for m in wmi.WmiMonitorID():
                    name = m.InstanceName.replace(&#39;_0&#39;,&#39;&#39;,1).split(&#39;\\&#39;)[2]
                    if name in monitor_uids.keys():
                        monitors.append(m)
                    else:
                        extras.append(m)

                # sort the monitors in the same order as win32api reports them
                # because the first item in win32api&#39;s list is usually the primary display
                monitors = sorted(monitors, key=lambda x:list(monitor_uids.keys()).index(x.InstanceName.replace(&#39;_0&#39;,&#39;&#39;,1).split(&#39;\\&#39;)[2]))
                monitors+=extras

                # get all available edid strings
                try:descriptors = {i.InstanceName:i.WmiGetMonitorRawEEdidV1Block(0) for i in wmi.WmiMonitorDescriptorMethods()}
                except:pass
                a=0
                for monitor in monitors:
                    valid = False
                    name, model, serial, manufacturer, man_id, edid = None, None, None, None, None, None
                    try:
                        serial = bytes(monitor.SerialNumberID).decode().replace(&#39;\x00&#39;, &#39;&#39;)
                        manufacturer, model = bytes(monitor.UserFriendlyName).decode().replace(&#39;\x00&#39;, &#39;&#39;).split(&#39; &#39;)
                        manufacturer = manufacturer.lower().capitalize()
                        try:
                            man_id, manufacturer = _monitor_brand_lookup(manufacturer)
                        except:
                            man_id = None
                        try:
                            edid = &#39;&#39;
                            for char in descriptors[monitor.InstanceName][0]:
                                char = str(hex(char)).replace(&#39;0x&#39;,&#39;&#39;)
                                if len(char) == 1:
                                    char = &#39;0&#39;+char
                                edid+=char
                        except:
                            edid = None
                        if manufacturer==&#39;Dell&#39;:
                            raise Exception
                        valid = True
                    except:
                        try:
                            # if there&#39;s an error scraping the WMI data, try scraping more basic data instead
                            monitor = monitor_uids[monitor.InstanceName.replace(&#39;_0&#39;,&#39;&#39;,1).split(&#39;\\&#39;)[2]]
                            dev_id = monitor.DeviceID.split(&#39;#&#39;)
                            serial = dev_id[2] # not an actual serial but the Windows UID
                            man_id = dev_id[1][:3]
                            model = dev_id[1][3:]
                            try:
                                man_id, manufacturer = _monitor_brand_lookup(man_id)
                            except:
                                manufacturer = None
                            try:
                                edid = &#39;&#39;
                                for char in descriptors[monitor.InstanceName][0]:
                                    char = str(hex(char)).replace(&#39;0x&#39;,&#39;&#39;)
                                    if len(char) == 1:
                                        char = &#39;0&#39;+char
                                    edid+=char
                            except:
                                edid = None
                            valid = True
                        except:
                            pass
                    if valid:
                        info.append({&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: VCP, &#39;edid&#39;: edid})
                        a+=1
            except:
                pass
            __cache__.store(&#39;vcp_monitor_info&#39;, info)
        if display!=None:
            try:
                info = filter_monitors(display=display, haystack=info)
                return info[0] if len(info)==1 else info
            except:
                pass
        return info
    def get_monitor_caps(monitor):
        &#39;&#39;&#39;
        Fetches and returns the VCP capabilities string of a monitor.
        This function takes anywhere from 1-2 seconds to run

        Args:
            monitor: a monitor handle as returned by `VCP.iter_physical_monitors()`
        
        Returns:
            str: a string of the monitor&#39;s capabilities
        
        Examples:
            ```python
            import screen_brightness_control as sbc

            for monitor in sbc.windows.VCP.iter_physical_monitors():
                print(sbc.windows.VCP.get_monitor_caps(monitor))
            # EG output: &#39;(prot(monitor)type(LCD)model(GL2450HM)cmds(01 02 03 07 0C F3)vcp(02 04 05 08 0B 0C 10 12 14(04 05 08 0B) 16 18 1A 52 60(01 03 11)62 8D(01 02)AC AE B2 B6 C0 C6 C8 C9 CA(01 02) CC(01 02 03 04 05 06 09 0A 0B 0D 0E 12 14 1A 1E 1F 20)D6(01 05) DF)mswhql(1)mccs_ver(2.1)asset_eep(32)mpu_ver(1.02))&#39;
            ```
        &#39;&#39;&#39;
        caps_string_length = DWORD()
        if not windll.dxva2.GetCapabilitiesStringLength(monitor,ctypes.byref(caps_string_length)):
            return
        caps_string = (ctypes.c_char * caps_string_length.value)()
        if not windll.dxva2.CapabilitiesRequestAndCapabilitiesReply(monitor, caps_string, caps_string_length):
            return
        return caps_string.value.decode(&#39;ASCII&#39;)
    def get_display_names():
        &#39;&#39;&#39;
        Return the names of each detected monitor
        
        Returns:
            list: list of strings
        
        Example:
            ```python
            import screen_brightness_control as sbc

            names = sbc.windows.VCP.get_display_names()
            print(names)
            # EG output: [&#39;BenQ GL2450H&#39;, &#39;Dell U2211H&#39;]
            ```
        &#39;&#39;&#39;
        return [i[&#39;name&#39;] for i in VCP.get_display_info()]
    def get_brightness(display=None):
        &#39;&#39;&#39;
        Retrieve the brightness of all connected displays using the `ctypes.windll` API

        Args:
            display (int or str): the specific display you wish to query. Is passed to `filter_monitors` to match to a display
        
        Returns:
            list: list of ints from 0 to 100 if multiple displays are detected and the `display` kwarg is not set
            int: from 0 to 100 if there is only one display detected or the `display` kwarg is set
        
        Examples:
            ```python
            import screen_brightness_control as sbc

            # Get the brightness for all detected displays
            current_brightness = sbc.windows.VCP.get_brightness()
            if type(current_brightness) is int:
                print(&#39;There is only one detected display&#39;)
            else:
                print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)
            
            # Get the brightness for the primary display
            primary_brightness = sbc.windows.VCP.get_brightness(display = 0)

            # Get the brightness for a secondary display
            secondary_brightness = sbc.windows.VCP.get_brightness(display = 1)

            # Get the brightness for a display with the model &#39;GL2450H&#39;
            benq_brightness = sbc.windows.VCP.get_brightness(display = &#39;GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        if display!=None:
            all_monitors = VCP.get_display_info()
            monitors = filter_monitors(display = display, haystack=all_monitors)
            indexes = [i[&#39;index&#39;] for i in monitors]

        count = 0
        values = []
        for m in VCP.iter_physical_monitors():
            try:
                v = __cache__.get(&#39;vcp_&#39;+all_monitors[count][&#39;serial&#39;]+&#39;_brightness&#39;)
            except:
                cur_out = DWORD()
                for i in range(10):
                    if windll.dxva2.GetVCPFeatureAndVCPFeatureReply(HANDLE(m), BYTE(0x10), None, byref(cur_out), None):
                        v = cur_out.value
                        break
                    else:
                        time.sleep(0.02)
                        v = None
                del(cur_out)
            if v!=None and (display==None or (count in indexes)):
                if display!=None and count in indexes:
                    try:__cache__.store(&#39;vcp_&#39;+all_monitors[count][&#39;serial&#39;]+&#39;_brightness&#39;, v, expires=0.1)
                    except IndexError:pass
                values.append(v)
            count+=1

        if values==[]:
            return None
        return values[0] if len(values)==1 else values
    def set_brightness(value, display=None, no_return=False):
        &#39;&#39;&#39;
        Sets the brightness for all connected displays using the `ctypes.windll` API

        Args:
            display (int or str): the specific display you wish to query. Is passed to `filter_monitors` to match to a display
            no_return (bool): if set to `True` this function will return `None`
        
        Returns:
            The result of `VCP.get_brightness()` (with the same `display` kwarg) if `no_return` is not set
        
        Examples:
            ```python
            import screen_brightness_control as sbc

            # Set the brightness for all detected displays to 50%
            sbc.windows.VCP.set_brightness(50)
            
            # Set the brightness for the primary display to 75%
            sbc.windows.VCP.set_brightness(75, display = 0)

            # Set the brightness for a secondary display to 25%
            sbc.windows.VCP.set_brightness(25, display = 1)

            # Set the brightness for a display with the model &#39;GL2450H&#39; to 100%
            sbc.windows.VCP.set_brightness(100, display = &#39;GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        if display!=None:
            indexes = [i[&#39;index&#39;] for i in filter_monitors(display = display, haystack = VCP.get_display_info())]

        __cache__.expire(startswith=&#39;vcp_&#39;, endswith=&#39;_brightness&#39;)

        count = 0
        for m in VCP.iter_physical_monitors():
            if display==None or (count in indexes):
                for i in range(10):
                    if windll.dxva2.SetVCPFeature(HANDLE(m), BYTE(0x10), DWORD(value)):
                        break
                    else:
                        time.sleep(0.02)
            count+=1
        return VCP.get_brightness(display=display) if not no_return else None</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="screen_brightness_control.windows.VCP.filter_displays"><code class="name flex">
<span>def <span class="ident">filter_displays</span></span>(<span>display, *args)</span>
</code></dt>
<dd>
<div class="desc"><p>Deprecated. Redirects to top-level <code>filter_monitors</code> function.
Searches through the information for all detected VCP displays and attempts to return the info matching the value given.
Will attempt to match against index, name, model, edid and serial</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>args</code></strong> :&ensp;<code>tuple</code></dt>
<dd>[<em>Optional</em>] if <code>args</code> isn't empty the function searches through args[0]. Otherwise it searches through the return of <code><a title="screen_brightness_control.windows.VCP.get_display_info" href="#screen_brightness_control.windows.VCP.get_display_info">VCP.get_display_info()</a></code></dd>
<dt><strong><code>display</code></strong> :&ensp;<code>str</code> or <code>int</code></dt>
<dd>what you are searching for. Can be serial number, name, model number, edid string or index of the display</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>IndexError</code></dt>
<dd>if the display value is an int and an <code>IndexError</code> occurs when using it as a list index</dd>
<dt><code>LookupError</code></dt>
<dd>if the display, as a str, does not have a match</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>dict</p>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

search = 'GL2450H'
match = sbc.windows.VCP.filter_displays(search)
print(match)
# EG output: {'name': 'BenQ GL2450H', 'model': 'GL2450H', ... }
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def filter_displays(display, *args):
    &#39;&#39;&#39;
    Deprecated. Redirects to top-level `filter_monitors` function.
    Searches through the information for all detected VCP displays and attempts to return the info matching the value given.
    Will attempt to match against index, name, model, edid and serial

    Args:
        args (tuple): [*Optional*] if `args` isn&#39;t empty the function searches through args[0]. Otherwise it searches through the return of `VCP.get_display_info()`
        display (str or int): what you are searching for. Can be serial number, name, model number, edid string or index of the display

    Raises:
        IndexError: if the display value is an int and an `IndexError` occurs when using it as a list index
        LookupError: if the display, as a str, does not have a match

    Returns:
        dict
    
    Example:
        ```python
        import screen_brightness_control as sbc

        search = &#39;GL2450H&#39;
        match = sbc.windows.VCP.filter_displays(search)
        print(match)
        # EG output: {&#39;name&#39;: &#39;BenQ GL2450H&#39;, &#39;model&#39;: &#39;GL2450H&#39;, ... }
        ```
    &#39;&#39;&#39;
    if len(args)==1:
        info = args[0]
    else:
        info = VCP.get_display_info()
    return filter_monitors(display = display, haystack = info)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.get_brightness"><code class="name flex">
<span>def <span class="ident">get_brightness</span></span>(<span>display=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Retrieve the brightness of all connected displays using the <code>ctypes.windll</code> API</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>the specific display you wish to query. Is passed to <code>filter_monitors</code> to match to a display</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of ints from 0 to 100 if multiple displays are detected and the <code>display</code> kwarg is not set</dd>
<dt><code>int</code></dt>
<dd>from 0 to 100 if there is only one display detected or the <code>display</code> kwarg is set</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# Get the brightness for all detected displays
current_brightness = sbc.windows.VCP.get_brightness()
if type(current_brightness) is int:
    print('There is only one detected display')
else:
    print('There are', len(current_brightness), 'detected displays')

# Get the brightness for the primary display
primary_brightness = sbc.windows.VCP.get_brightness(display = 0)

# Get the brightness for a secondary display
secondary_brightness = sbc.windows.VCP.get_brightness(display = 1)

# Get the brightness for a display with the model 'GL2450H'
benq_brightness = sbc.windows.VCP.get_brightness(display = 'GL2450H')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_brightness(display=None):
    &#39;&#39;&#39;
    Retrieve the brightness of all connected displays using the `ctypes.windll` API

    Args:
        display (int or str): the specific display you wish to query. Is passed to `filter_monitors` to match to a display
    
    Returns:
        list: list of ints from 0 to 100 if multiple displays are detected and the `display` kwarg is not set
        int: from 0 to 100 if there is only one display detected or the `display` kwarg is set
    
    Examples:
        ```python
        import screen_brightness_control as sbc

        # Get the brightness for all detected displays
        current_brightness = sbc.windows.VCP.get_brightness()
        if type(current_brightness) is int:
            print(&#39;There is only one detected display&#39;)
        else:
            print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)
        
        # Get the brightness for the primary display
        primary_brightness = sbc.windows.VCP.get_brightness(display = 0)

        # Get the brightness for a secondary display
        secondary_brightness = sbc.windows.VCP.get_brightness(display = 1)

        # Get the brightness for a display with the model &#39;GL2450H&#39;
        benq_brightness = sbc.windows.VCP.get_brightness(display = &#39;GL2450H&#39;)
        ```
    &#39;&#39;&#39;
    if display!=None:
        all_monitors = VCP.get_display_info()
        monitors = filter_monitors(display = display, haystack=all_monitors)
        indexes = [i[&#39;index&#39;] for i in monitors]

    count = 0
    values = []
    for m in VCP.iter_physical_monitors():
        try:
            v = __cache__.get(&#39;vcp_&#39;+all_monitors[count][&#39;serial&#39;]+&#39;_brightness&#39;)
        except:
            cur_out = DWORD()
            for i in range(10):
                if windll.dxva2.GetVCPFeatureAndVCPFeatureReply(HANDLE(m), BYTE(0x10), None, byref(cur_out), None):
                    v = cur_out.value
                    break
                else:
                    time.sleep(0.02)
                    v = None
            del(cur_out)
        if v!=None and (display==None or (count in indexes)):
            if display!=None and count in indexes:
                try:__cache__.store(&#39;vcp_&#39;+all_monitors[count][&#39;serial&#39;]+&#39;_brightness&#39;, v, expires=0.1)
                except IndexError:pass
            values.append(v)
        count+=1

    if values==[]:
        return None
    return values[0] if len(values)==1 else values</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.get_display_info"><code class="name flex">
<span>def <span class="ident">get_display_info</span></span>(<span>display=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a dictionary of info about all detected monitors or a selection of monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>[<em>Optional</em>] the monitor to return info about. Pass in the serial number, name, model, edid or index</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of dicts if <code>args</code> is empty or there are multiple values passed in <code>args</code></dd>
<dt><code>dict</code></dt>
<dd>if one value was passed through <code>args</code> and it matched a known monitor</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# get the information about all monitors
vcp_info = sbc.windows.VCP.get_display_info()
print(vcp_info)
# EG output: [{'name': 'BenQ GL2450H', 'model': 'GL2450H', ... }, {'name': 'Dell U2211H', 'model': 'U2211H', ... }]

# get information about a monitor with this specific model
bnq_info = sbc.windows.VCP.get_display_info('GL2450H')
# EG output: {'name': 'BenQ GL2450H', 'model': 'GL2450H', ... }
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_display_info(display=None):
    &#39;&#39;&#39;
    Returns a dictionary of info about all detected monitors or a selection of monitors

    Args:
        display (int or str): [*Optional*] the monitor to return info about. Pass in the serial number, name, model, edid or index

    Returns:
        list: list of dicts if `args` is empty or there are multiple values passed in `args`
        dict: if one value was passed through `args` and it matched a known monitor
    
    Example:
        ```python
        import screen_brightness_control as sbc

        # get the information about all monitors
        vcp_info = sbc.windows.VCP.get_display_info()
        print(vcp_info)
        # EG output: [{&#39;name&#39;: &#39;BenQ GL2450H&#39;, &#39;model&#39;: &#39;GL2450H&#39;, ... }, {&#39;name&#39;: &#39;Dell U2211H&#39;, &#39;model&#39;: &#39;U2211H&#39;, ... }]

        # get information about a monitor with this specific model
        bnq_info = sbc.windows.VCP.get_display_info(&#39;GL2450H&#39;)
        # EG output: {&#39;name&#39;: &#39;BenQ GL2450H&#39;, &#39;model&#39;: &#39;GL2450H&#39;, ... }
        ```
    &#39;&#39;&#39;
    try:
        info = __cache__.get(&#39;vcp_monitor_info&#39;)
    except:
        info = []
        try:
            # collect all monitor UIDs (derived from DeviceID)
            monitor_uids = {}
            for i in win32api.EnumDisplayMonitors():
                tmp = win32api.GetMonitorInfo(i[0])
                device = None
                # iterate up to 4 display adapters
                for j in range(5):
                    try:
                        # i have no idea what this 3rd parameter does but the code doesn&#39;t work without it
                        device = win32api.EnumDisplayDevices(tmp[&#39;Device&#39;], j, 1)
                        break
                    except:
                        pass
                if device!=None:
                    monitor_uids[device.DeviceID.split(&#39;#&#39;)[2]] = device
                    #monitor_uids.append(device.DeviceID.split(&#39;#&#39;)[2])

            # this seperation of monitors is to fix issue #6
            # https://github.com/Crozzers/screen_brightness_control/issues/6
            wmi = _wmi_init()
            monitors = []
            extras = []
            for m in wmi.WmiMonitorID():
                name = m.InstanceName.replace(&#39;_0&#39;,&#39;&#39;,1).split(&#39;\\&#39;)[2]
                if name in monitor_uids.keys():
                    monitors.append(m)
                else:
                    extras.append(m)

            # sort the monitors in the same order as win32api reports them
            # because the first item in win32api&#39;s list is usually the primary display
            monitors = sorted(monitors, key=lambda x:list(monitor_uids.keys()).index(x.InstanceName.replace(&#39;_0&#39;,&#39;&#39;,1).split(&#39;\\&#39;)[2]))
            monitors+=extras

            # get all available edid strings
            try:descriptors = {i.InstanceName:i.WmiGetMonitorRawEEdidV1Block(0) for i in wmi.WmiMonitorDescriptorMethods()}
            except:pass
            a=0
            for monitor in monitors:
                valid = False
                name, model, serial, manufacturer, man_id, edid = None, None, None, None, None, None
                try:
                    serial = bytes(monitor.SerialNumberID).decode().replace(&#39;\x00&#39;, &#39;&#39;)
                    manufacturer, model = bytes(monitor.UserFriendlyName).decode().replace(&#39;\x00&#39;, &#39;&#39;).split(&#39; &#39;)
                    manufacturer = manufacturer.lower().capitalize()
                    try:
                        man_id, manufacturer = _monitor_brand_lookup(manufacturer)
                    except:
                        man_id = None
                    try:
                        edid = &#39;&#39;
                        for char in descriptors[monitor.InstanceName][0]:
                            char = str(hex(char)).replace(&#39;0x&#39;,&#39;&#39;)
                            if len(char) == 1:
                                char = &#39;0&#39;+char
                            edid+=char
                    except:
                        edid = None
                    if manufacturer==&#39;Dell&#39;:
                        raise Exception
                    valid = True
                except:
                    try:
                        # if there&#39;s an error scraping the WMI data, try scraping more basic data instead
                        monitor = monitor_uids[monitor.InstanceName.replace(&#39;_0&#39;,&#39;&#39;,1).split(&#39;\\&#39;)[2]]
                        dev_id = monitor.DeviceID.split(&#39;#&#39;)
                        serial = dev_id[2] # not an actual serial but the Windows UID
                        man_id = dev_id[1][:3]
                        model = dev_id[1][3:]
                        try:
                            man_id, manufacturer = _monitor_brand_lookup(man_id)
                        except:
                            manufacturer = None
                        try:
                            edid = &#39;&#39;
                            for char in descriptors[monitor.InstanceName][0]:
                                char = str(hex(char)).replace(&#39;0x&#39;,&#39;&#39;)
                                if len(char) == 1:
                                    char = &#39;0&#39;+char
                                edid+=char
                        except:
                            edid = None
                        valid = True
                    except:
                        pass
                if valid:
                    info.append({&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: VCP, &#39;edid&#39;: edid})
                    a+=1
        except:
            pass
        __cache__.store(&#39;vcp_monitor_info&#39;, info)
    if display!=None:
        try:
            info = filter_monitors(display=display, haystack=info)
            return info[0] if len(info)==1 else info
        except:
            pass
    return info</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.get_display_names"><code class="name flex">
<span>def <span class="ident">get_display_names</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Return the names of each detected monitor</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of strings</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

names = sbc.windows.VCP.get_display_names()
print(names)
# EG output: ['BenQ GL2450H', 'Dell U2211H']
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_display_names():
    &#39;&#39;&#39;
    Return the names of each detected monitor
    
    Returns:
        list: list of strings
    
    Example:
        ```python
        import screen_brightness_control as sbc

        names = sbc.windows.VCP.get_display_names()
        print(names)
        # EG output: [&#39;BenQ GL2450H&#39;, &#39;Dell U2211H&#39;]
        ```
    &#39;&#39;&#39;
    return [i[&#39;name&#39;] for i in VCP.get_display_info()]</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.get_monitor_caps"><code class="name flex">
<span>def <span class="ident">get_monitor_caps</span></span>(<span>monitor)</span>
</code></dt>
<dd>
<div class="desc"><p>Fetches and returns the VCP capabilities string of a monitor.
This function takes anywhere from 1-2 seconds to run</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>monitor</code></strong></dt>
<dd>a monitor handle as returned by <code><a title="screen_brightness_control.windows.VCP.iter_physical_monitors" href="#screen_brightness_control.windows.VCP.iter_physical_monitors">VCP.iter_physical_monitors()</a></code></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>a string of the monitor's capabilities</dd>
</dl>
<h2 id="examples">Examples</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

for monitor in sbc.windows.VCP.iter_physical_monitors():
    print(sbc.windows.VCP.get_monitor_caps(monitor))
# EG output: '(prot(monitor)type(LCD)model(GL2450HM)cmds(01 02 03 07 0C F3)vcp(02 04 05 08 0B 0C 10 12 14(04 05 08 0B) 16 18 1A 52 60(01 03 11)62 8D(01 02)AC AE B2 B6 C0 C6 C8 C9 CA(01 02) CC(01 02 03 04 05 06 09 0A 0B 0D 0E 12 14 1A 1E 1F 20)D6(01 05) DF)mswhql(1)mccs_ver(2.1)asset_eep(32)mpu_ver(1.02))'
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_monitor_caps(monitor):
    &#39;&#39;&#39;
    Fetches and returns the VCP capabilities string of a monitor.
    This function takes anywhere from 1-2 seconds to run

    Args:
        monitor: a monitor handle as returned by `VCP.iter_physical_monitors()`
    
    Returns:
        str: a string of the monitor&#39;s capabilities
    
    Examples:
        ```python
        import screen_brightness_control as sbc

        for monitor in sbc.windows.VCP.iter_physical_monitors():
            print(sbc.windows.VCP.get_monitor_caps(monitor))
        # EG output: &#39;(prot(monitor)type(LCD)model(GL2450HM)cmds(01 02 03 07 0C F3)vcp(02 04 05 08 0B 0C 10 12 14(04 05 08 0B) 16 18 1A 52 60(01 03 11)62 8D(01 02)AC AE B2 B6 C0 C6 C8 C9 CA(01 02) CC(01 02 03 04 05 06 09 0A 0B 0D 0E 12 14 1A 1E 1F 20)D6(01 05) DF)mswhql(1)mccs_ver(2.1)asset_eep(32)mpu_ver(1.02))&#39;
        ```
    &#39;&#39;&#39;
    caps_string_length = DWORD()
    if not windll.dxva2.GetCapabilitiesStringLength(monitor,ctypes.byref(caps_string_length)):
        return
    caps_string = (ctypes.c_char * caps_string_length.value)()
    if not windll.dxva2.CapabilitiesRequestAndCapabilitiesReply(monitor, caps_string, caps_string_length):
        return
    return caps_string.value.decode(&#39;ASCII&#39;)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.iter_physical_monitors"><code class="name flex">
<span>def <span class="ident">iter_physical_monitors</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>A generator to iterate through all physical monitors and then close them again afterwards, yielding their handles.
It is not recommended to use this function unless you are familiar with <code>ctypes</code> and <code>windll</code></p>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>ctypes.WinError</code></dt>
<dd>upon failure to enumerate through the monitors</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

for monitor in sbc.windows.VCP.iter_physical_monitors():
    print(sbc.windows.VCP.get_monitor_caps(monitor))
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def iter_physical_monitors():
    &#39;&#39;&#39;
    A generator to iterate through all physical monitors and then close them again afterwards, yielding their handles.
    It is not recommended to use this function unless you are familiar with `ctypes` and `windll`

    Raises:
        ctypes.WinError: upon failure to enumerate through the monitors

    Example:
        ```python
        import screen_brightness_control as sbc

        for monitor in sbc.windows.VCP.iter_physical_monitors():
            print(sbc.windows.VCP.get_monitor_caps(monitor))
        ```
    &#39;&#39;&#39;
    def callback(hmonitor, hdc, lprect, lparam):
        monitors.append(HMONITOR(hmonitor))
        return True

    monitors = []
    if not windll.user32.EnumDisplayMonitors(None, None, VCP._MONITORENUMPROC(callback), None):
        raise WinError(&#39;EnumDisplayMonitors failed&#39;)
    for monitor in monitors:
        # Get physical monitor count
        count = DWORD()
        if not windll.dxva2.GetNumberOfPhysicalMonitorsFromHMONITOR(monitor, byref(count)):
            raise WinError()
        if count.value&gt;0:
            # Get physical monitor handles
            physical_array = (VCP._PHYSICAL_MONITOR * count.value)()
            if not windll.dxva2.GetPhysicalMonitorsFromHMONITOR(monitor, count.value, physical_array):
                raise WinError()
            for item in physical_array:
                yield item.handle
                windll.dxva2.DestroyPhysicalMonitor(item.handle)</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.VCP.set_brightness"><code class="name flex">
<span>def <span class="ident">set_brightness</span></span>(<span>value, display=None, no_return=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Sets the brightness for all connected displays using the <code>ctypes.windll</code> API</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>the specific display you wish to query. Is passed to <code>filter_monitors</code> to match to a display</dd>
<dt><strong><code>no_return</code></strong> :&ensp;<code>bool</code></dt>
<dd>if set to <code>True</code> this function will return <code>None</code></dd>
</dl>
<h2 id="returns">Returns</h2>
<p>The result of <code><a title="screen_brightness_control.windows.VCP.get_brightness" href="#screen_brightness_control.windows.VCP.get_brightness">VCP.get_brightness()</a></code> (with the same <code>display</code> kwarg) if <code>no_return</code> is not set</p>
<h2 id="examples">Examples</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# Set the brightness for all detected displays to 50%
sbc.windows.VCP.set_brightness(50)

# Set the brightness for the primary display to 75%
sbc.windows.VCP.set_brightness(75, display = 0)

# Set the brightness for a secondary display to 25%
sbc.windows.VCP.set_brightness(25, display = 1)

# Set the brightness for a display with the model 'GL2450H' to 100%
sbc.windows.VCP.set_brightness(100, display = 'GL2450H')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_brightness(value, display=None, no_return=False):
    &#39;&#39;&#39;
    Sets the brightness for all connected displays using the `ctypes.windll` API

    Args:
        display (int or str): the specific display you wish to query. Is passed to `filter_monitors` to match to a display
        no_return (bool): if set to `True` this function will return `None`
    
    Returns:
        The result of `VCP.get_brightness()` (with the same `display` kwarg) if `no_return` is not set
    
    Examples:
        ```python
        import screen_brightness_control as sbc

        # Set the brightness for all detected displays to 50%
        sbc.windows.VCP.set_brightness(50)
        
        # Set the brightness for the primary display to 75%
        sbc.windows.VCP.set_brightness(75, display = 0)

        # Set the brightness for a secondary display to 25%
        sbc.windows.VCP.set_brightness(25, display = 1)

        # Set the brightness for a display with the model &#39;GL2450H&#39; to 100%
        sbc.windows.VCP.set_brightness(100, display = &#39;GL2450H&#39;)
        ```
    &#39;&#39;&#39;
    if display!=None:
        indexes = [i[&#39;index&#39;] for i in filter_monitors(display = display, haystack = VCP.get_display_info())]

    __cache__.expire(startswith=&#39;vcp_&#39;, endswith=&#39;_brightness&#39;)

    count = 0
    for m in VCP.iter_physical_monitors():
        if display==None or (count in indexes):
            for i in range(10):
                if windll.dxva2.SetVCPFeature(HANDLE(m), BYTE(0x10), DWORD(value)):
                    break
                else:
                    time.sleep(0.02)
        count+=1
    return VCP.get_brightness(display=display) if not no_return else None</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="screen_brightness_control.windows.WMI"><code class="flex name class">
<span>class <span class="ident">WMI</span></span>
</code></dt>
<dd>
<div class="desc"><p>collection of screen brightness related methods using the WMI API</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class WMI:
    &#39;&#39;&#39;collection of screen brightness related methods using the WMI API&#39;&#39;&#39;
    def get_display_info(display=None):
        &#39;&#39;&#39;
        Returns a dictionary of info about all detected monitors

        Args:
            display (str or int): [*Optional*] the monitor to return info about. Pass in the serial number, name, model, edid or index

        Returns:
            list: list of dictonaries
            dict: one dictionary if a monitor is specified
        
        Example:
            ```python
            import screen_brightness_control as sbc

            info = sbc.windows.WMI.get_display_info()
            for i in info:
                print(&#39;================&#39;)
                for key, value in i.items():
                    print(key, &#39;:&#39;, value)

            # get information about the first WMI addressable monitor
            primary_info = sbc.windows.WMI.get_display_info(0)

            # get information about a monitor with a specific name
            benq_info = sbc.windows.WMI.get_display_info(&#39;BenQ GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        try:
            info = __cache__.get(&#39;wmi_monitor_info&#39;)
        except:
            info = []
            a = 0
            try:
                wmi = _wmi_init()
                monitors = wmi.WmiMonitorBrightness()
                try:descriptors = {i.InstanceName:i.WmiGetMonitorRawEEdidV1Block(0) for i in wmi.WmiMonitorDescriptorMethods()}
                except:pass
                for m in monitors:
                    instance = m.InstanceName.split(&#39;\\&#39;)
                    serial = instance[-1]
                    model = instance[1]

                    man_id = model[:3]
                    try:man_id, manufacturer = _monitor_brand_lookup(model[:3])
                    except:manufacturer = None

                    try:
                        edid = &#39;&#39;
                        for char in descriptors[m.InstanceName][0]:
                            char = str(hex(char)).replace(&#39;0x&#39;,&#39;&#39;)
                            if len(char)==1:
                                char = &#39;0&#39;+char
                            edid+=char
                    except:
                        edid = None

                    info.append({&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: WMI, &#39;edid&#39;:edid})
                    a+=1
            except:
                pass
            __cache__.store(&#39;wmi_monitor_info&#39;, info)
        if display!=None:
            indexes = [i[&#39;index&#39;] for i in filter_monitors(display=display, haystack=info)]
            info = [info[i] for i in indexes]
        return info
    def get_display_names():
        &#39;&#39;&#39;
        Returns names of all displays that can be addressed by WMI

        Returns:
            list: list of strings
        
        Example:
            ```python
            import screen_brightness_control as sbc

            for name in sbc.windows.WMI.get_display_names():
                print(name)
            ```
        &#39;&#39;&#39;
        return [i[&#39;name&#39;] for i in WMI.get_display_info()]
    def set_brightness(value, display = None, no_return = False):
        &#39;&#39;&#39;
        Sets the display brightness for Windows using WMI

        Args:
            value (int): The percentage to set the brightness to
            display (int or str): The index display you wish to set the brightness for OR the model of the display, as returned by self.get_display_names
            no_return (bool): if True, this function returns None, otherwise it returns the result of `WMI.get_brightness()`

        Returns:
            int: from 0 to 100 if only one display&#39;s brightness is requested
            list: list of integers if multiple displays are requested
            None: if `no_return` is set to `True`
        
        Raises:
            LookupError: if the given display cannot be found

        Example:
            ```python
            import screen_brightness_control as sbc

            # set brightness of WMI addressable monitors to 50%
            sbc.windows.WMI.set_brightness(50)

            # set the primary display brightness to 75%
            sbc.windows.WMI.set_brightness(75, display = 0)

            # set the brightness of a named monitor to 25%
            sbc.windows.WMI.set_brightness(25, display = &#39;BenQ GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        brightness_method = _wmi_init().WmiMonitorBrightnessMethods()
        if display!=None:
            indexes = [i[&#39;index&#39;] for i in filter_monitors(display=display, method=&#39;wmi&#39;)]
            brightness_method = [brightness_method[i] for i in indexes]
        for method in brightness_method:
            method.WmiSetBrightness(value,0)
        return WMI.get_brightness(display=display) if not no_return else None
    def get_brightness(display = None):
        &#39;&#39;&#39;
        Returns the current display brightness using the `wmi` API

        Args:
            display (int): The index display you wish to get the brightness of OR the model of that display

        Returns:
            int: from 0 to 100 if only one display&#39;s brightness is requested
            list: list of integers if multiple displays are requested
        
        Raises:
            LookupError: if the given display cannot be found
        
        Example:
            ```python
            import screen_brightness_control as sbc

            # get brightness of all WMI addressable monitors
            current_brightness = sbc.windows.WMI.get_brightness()
            if type(current_brightness) is int:
                print(&#39;There is only one detected display&#39;)
            else:
                print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

            # get the primary display brightness
            primary_brightness = sbc.windows.WMI.get_brightness(display = 0)

            # get the brightness of a named monitor
            benq_brightness = sbc.windows.WMI.get_brightness(display = &#39;BenQ GL2450H&#39;)
            ```
        &#39;&#39;&#39;
        brightness_method = _wmi_init().WmiMonitorBrightness()
        if display!=None:
            displays = WMI.get_display_info(display)
            if displays is dict:
                displays = [displays]
            brightness_method = [brightness_method[i[&#39;index&#39;]] for i in displays]

        values = [i.CurrentBrightness for i in brightness_method]
        return values[0] if len(values)==1 else values</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="screen_brightness_control.windows.WMI.get_brightness"><code class="name flex">
<span>def <span class="ident">get_brightness</span></span>(<span>display=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the current display brightness using the <code>wmi</code> API</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code></dt>
<dd>The index display you wish to get the brightness of OR the model of that display</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>from 0 to 100 if only one display's brightness is requested</dd>
<dt><code>list</code></dt>
<dd>list of integers if multiple displays are requested</dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>LookupError</code></dt>
<dd>if the given display cannot be found</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# get brightness of all WMI addressable monitors
current_brightness = sbc.windows.WMI.get_brightness()
if type(current_brightness) is int:
    print('There is only one detected display')
else:
    print('There are', len(current_brightness), 'detected displays')

# get the primary display brightness
primary_brightness = sbc.windows.WMI.get_brightness(display = 0)

# get the brightness of a named monitor
benq_brightness = sbc.windows.WMI.get_brightness(display = 'BenQ GL2450H')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_brightness(display = None):
    &#39;&#39;&#39;
    Returns the current display brightness using the `wmi` API

    Args:
        display (int): The index display you wish to get the brightness of OR the model of that display

    Returns:
        int: from 0 to 100 if only one display&#39;s brightness is requested
        list: list of integers if multiple displays are requested
    
    Raises:
        LookupError: if the given display cannot be found
    
    Example:
        ```python
        import screen_brightness_control as sbc

        # get brightness of all WMI addressable monitors
        current_brightness = sbc.windows.WMI.get_brightness()
        if type(current_brightness) is int:
            print(&#39;There is only one detected display&#39;)
        else:
            print(&#39;There are&#39;, len(current_brightness), &#39;detected displays&#39;)

        # get the primary display brightness
        primary_brightness = sbc.windows.WMI.get_brightness(display = 0)

        # get the brightness of a named monitor
        benq_brightness = sbc.windows.WMI.get_brightness(display = &#39;BenQ GL2450H&#39;)
        ```
    &#39;&#39;&#39;
    brightness_method = _wmi_init().WmiMonitorBrightness()
    if display!=None:
        displays = WMI.get_display_info(display)
        if displays is dict:
            displays = [displays]
        brightness_method = [brightness_method[i[&#39;index&#39;]] for i in displays]

    values = [i.CurrentBrightness for i in brightness_method]
    return values[0] if len(values)==1 else values</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.WMI.get_display_info"><code class="name flex">
<span>def <span class="ident">get_display_info</span></span>(<span>display=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns a dictionary of info about all detected monitors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>display</code></strong> :&ensp;<code>str</code> or <code>int</code></dt>
<dd>[<em>Optional</em>] the monitor to return info about. Pass in the serial number, name, model, edid or index</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of dictonaries</dd>
<dt><code>dict</code></dt>
<dd>one dictionary if a monitor is specified</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

info = sbc.windows.WMI.get_display_info()
for i in info:
    print('================')
    for key, value in i.items():
        print(key, ':', value)

# get information about the first WMI addressable monitor
primary_info = sbc.windows.WMI.get_display_info(0)

# get information about a monitor with a specific name
benq_info = sbc.windows.WMI.get_display_info('BenQ GL2450H')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_display_info(display=None):
    &#39;&#39;&#39;
    Returns a dictionary of info about all detected monitors

    Args:
        display (str or int): [*Optional*] the monitor to return info about. Pass in the serial number, name, model, edid or index

    Returns:
        list: list of dictonaries
        dict: one dictionary if a monitor is specified
    
    Example:
        ```python
        import screen_brightness_control as sbc

        info = sbc.windows.WMI.get_display_info()
        for i in info:
            print(&#39;================&#39;)
            for key, value in i.items():
                print(key, &#39;:&#39;, value)

        # get information about the first WMI addressable monitor
        primary_info = sbc.windows.WMI.get_display_info(0)

        # get information about a monitor with a specific name
        benq_info = sbc.windows.WMI.get_display_info(&#39;BenQ GL2450H&#39;)
        ```
    &#39;&#39;&#39;
    try:
        info = __cache__.get(&#39;wmi_monitor_info&#39;)
    except:
        info = []
        a = 0
        try:
            wmi = _wmi_init()
            monitors = wmi.WmiMonitorBrightness()
            try:descriptors = {i.InstanceName:i.WmiGetMonitorRawEEdidV1Block(0) for i in wmi.WmiMonitorDescriptorMethods()}
            except:pass
            for m in monitors:
                instance = m.InstanceName.split(&#39;\\&#39;)
                serial = instance[-1]
                model = instance[1]

                man_id = model[:3]
                try:man_id, manufacturer = _monitor_brand_lookup(model[:3])
                except:manufacturer = None

                try:
                    edid = &#39;&#39;
                    for char in descriptors[m.InstanceName][0]:
                        char = str(hex(char)).replace(&#39;0x&#39;,&#39;&#39;)
                        if len(char)==1:
                            char = &#39;0&#39;+char
                        edid+=char
                except:
                    edid = None

                info.append({&#39;name&#39;:f&#39;{manufacturer} {model}&#39;, &#39;model&#39;:model, &#39;model_name&#39;: None, &#39;serial&#39;:serial, &#39;manufacturer&#39;: manufacturer, &#39;manufacturer_id&#39;: man_id , &#39;index&#39;: a, &#39;method&#39;: WMI, &#39;edid&#39;:edid})
                a+=1
        except:
            pass
        __cache__.store(&#39;wmi_monitor_info&#39;, info)
    if display!=None:
        indexes = [i[&#39;index&#39;] for i in filter_monitors(display=display, haystack=info)]
        info = [info[i] for i in indexes]
    return info</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.WMI.get_display_names"><code class="name flex">
<span>def <span class="ident">get_display_names</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Returns names of all displays that can be addressed by WMI</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>list</code></dt>
<dd>list of strings</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

for name in sbc.windows.WMI.get_display_names():
    print(name)
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_display_names():
    &#39;&#39;&#39;
    Returns names of all displays that can be addressed by WMI

    Returns:
        list: list of strings
    
    Example:
        ```python
        import screen_brightness_control as sbc

        for name in sbc.windows.WMI.get_display_names():
            print(name)
        ```
    &#39;&#39;&#39;
    return [i[&#39;name&#39;] for i in WMI.get_display_info()]</code></pre>
</details>
</dd>
<dt id="screen_brightness_control.windows.WMI.set_brightness"><code class="name flex">
<span>def <span class="ident">set_brightness</span></span>(<span>value, display=None, no_return=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Sets the display brightness for Windows using WMI</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>value</code></strong> :&ensp;<code>int</code></dt>
<dd>The percentage to set the brightness to</dd>
<dt><strong><code>display</code></strong> :&ensp;<code>int</code> or <code>str</code></dt>
<dd>The index display you wish to set the brightness for OR the model of the display, as returned by self.get_display_names</dd>
<dt><strong><code>no_return</code></strong> :&ensp;<code>bool</code></dt>
<dd>if True, this function returns None, otherwise it returns the result of <code><a title="screen_brightness_control.windows.WMI.get_brightness" href="#screen_brightness_control.windows.WMI.get_brightness">WMI.get_brightness()</a></code></dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>from 0 to 100 if only one display's brightness is requested</dd>
<dt><code>list</code></dt>
<dd>list of integers if multiple displays are requested</dd>
<dt><code>None</code></dt>
<dd>if <code>no_return</code> is set to <code>True</code></dd>
</dl>
<h2 id="raises">Raises</h2>
<dl>
<dt><code>LookupError</code></dt>
<dd>if the given display cannot be found</dd>
</dl>
<h2 id="example">Example</h2>
<pre><code class="language-python">import screen_brightness_control as sbc

# set brightness of WMI addressable monitors to 50%
sbc.windows.WMI.set_brightness(50)

# set the primary display brightness to 75%
sbc.windows.WMI.set_brightness(75, display = 0)

# set the brightness of a named monitor to 25%
sbc.windows.WMI.set_brightness(25, display = 'BenQ GL2450H')
</code></pre></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_brightness(value, display = None, no_return = False):
    &#39;&#39;&#39;
    Sets the display brightness for Windows using WMI

    Args:
        value (int): The percentage to set the brightness to
        display (int or str): The index display you wish to set the brightness for OR the model of the display, as returned by self.get_display_names
        no_return (bool): if True, this function returns None, otherwise it returns the result of `WMI.get_brightness()`

    Returns:
        int: from 0 to 100 if only one display&#39;s brightness is requested
        list: list of integers if multiple displays are requested
        None: if `no_return` is set to `True`
    
    Raises:
        LookupError: if the given display cannot be found

    Example:
        ```python
        import screen_brightness_control as sbc

        # set brightness of WMI addressable monitors to 50%
        sbc.windows.WMI.set_brightness(50)

        # set the primary display brightness to 75%
        sbc.windows.WMI.set_brightness(75, display = 0)

        # set the brightness of a named monitor to 25%
        sbc.windows.WMI.set_brightness(25, display = &#39;BenQ GL2450H&#39;)
        ```
    &#39;&#39;&#39;
    brightness_method = _wmi_init().WmiMonitorBrightnessMethods()
    if display!=None:
        indexes = [i[&#39;index&#39;] for i in filter_monitors(display=display, method=&#39;wmi&#39;)]
        brightness_method = [brightness_method[i] for i in indexes]
    for method in brightness_method:
        method.WmiSetBrightness(value,0)
    return WMI.get_brightness(display=display) if not no_return else None</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar"><a href="../../index.html">Back to the main page</a>
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="screen_brightness_control" href="index.html">screen_brightness_control</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="screen_brightness_control.windows.get_brightness" href="#screen_brightness_control.windows.get_brightness">get_brightness</a></code></li>
<li><code><a title="screen_brightness_control.windows.list_monitors" href="#screen_brightness_control.windows.list_monitors">list_monitors</a></code></li>
<li><code><a title="screen_brightness_control.windows.list_monitors_info" href="#screen_brightness_control.windows.list_monitors_info">list_monitors_info</a></code></li>
<li><code><a title="screen_brightness_control.windows.set_brightness" href="#screen_brightness_control.windows.set_brightness">set_brightness</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="screen_brightness_control.windows.VCP" href="#screen_brightness_control.windows.VCP">VCP</a></code></h4>
<ul class="">
<li><code><a title="screen_brightness_control.windows.VCP.filter_displays" href="#screen_brightness_control.windows.VCP.filter_displays">filter_displays</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.get_brightness" href="#screen_brightness_control.windows.VCP.get_brightness">get_brightness</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.get_display_info" href="#screen_brightness_control.windows.VCP.get_display_info">get_display_info</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.get_display_names" href="#screen_brightness_control.windows.VCP.get_display_names">get_display_names</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.get_monitor_caps" href="#screen_brightness_control.windows.VCP.get_monitor_caps">get_monitor_caps</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.iter_physical_monitors" href="#screen_brightness_control.windows.VCP.iter_physical_monitors">iter_physical_monitors</a></code></li>
<li><code><a title="screen_brightness_control.windows.VCP.set_brightness" href="#screen_brightness_control.windows.VCP.set_brightness">set_brightness</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="screen_brightness_control.windows.WMI" href="#screen_brightness_control.windows.WMI">WMI</a></code></h4>
<ul class="">
<li><code><a title="screen_brightness_control.windows.WMI.get_brightness" href="#screen_brightness_control.windows.WMI.get_brightness">get_brightness</a></code></li>
<li><code><a title="screen_brightness_control.windows.WMI.get_display_info" href="#screen_brightness_control.windows.WMI.get_display_info">get_display_info</a></code></li>
<li><code><a title="screen_brightness_control.windows.WMI.get_display_names" href="#screen_brightness_control.windows.WMI.get_display_names">get_display_names</a></code></li>
<li><code><a title="screen_brightness_control.windows.WMI.set_brightness" href="#screen_brightness_control.windows.WMI.set_brightness">set_brightness</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>

<h1>Documentation</h1>
<ul id="index">
<li><h3><a>Version</a></h3>

<ul id="docver_links_nojquery">
<li><a href="../../docver_links_redir.html">Change documentation version</a></li>
</ul>
<ul class="two-column" id="docver_links"><!--VERSION START-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $("#docver_links").load("../../docver_links_inline.html",
        function(resp_txt, txt_status, xmlhttp_req){
            if (txt_status=="success"){
                document.getElementById("docver_links_nojquery").innerHTML = "";
            }
            if (txt_status=="error"){
                document.getElementById("docver_links").setAttribute("class", "");
            }
    });
</script>
</ul></li></ul>

<h1>Meta</h1>
<ul id="index">
<li><h3><a>Github</a></h3>
<ul>
<li><code><a href="https://github.com/Crozzers/screen_brightness_control">Github Repository</a></code></li>
<li><code><a href="https://github.com/Crozzers/screen_brightness_control/releases">Releases</a></code></li>
<li><code><a href="https://github.com/Crozzers/screen_brightness_control/issues">Issue Tracker</a></code></li>
<li><code><a href="https://github.com/Crozzers/screen_brightness_control/pulls">Pull Requests</a></code></li>
</ul></li>
<li><h3 style='border-bottom:none;'><a href='https://pypi.org/project/screen_brightness_control'>PyPi</a></h3></li>
<li><h3 style='border-bottom:none;'><a href='https://mit-license.org'>License</a></h3></li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>